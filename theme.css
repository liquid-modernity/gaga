/* ========= Gaga — theme.css (stable hot-fix) ========= */

/* Tokens */
:root{
  --bg:#0B0E13; --fg:#EAEAF2; --muted:#B7C0D1; --line:#2A3040;
  --card:#141923; --raise:#0F1422; --accent:#D81B60;
  --ok:#27AE60; --warn:#E2B93B; --bad:#E53935;

  --center-max:880px; --center-min:360px; --center-pad:16px;
  --side-left:280px; --side-right:360px;
  --gap:10px; --r:16px; --chip:46px; --barh:64px;
  --safe-b:env(safe-area-inset-bottom,0px);
  --ts:1; --fz:calc(16px*var(--ts)); --fz-s:calc(14px*var(--ts)); --lh:1.65;
}
body[data-density="compact"]{ --chip:42px; --gap:8px }

/* Theme surfaces (dark default; light/glass bisa override via data-theme) */
body[data-theme="dark"]  { --surface:var(--bg); --elev:var(--card); --text:var(--fg); --sub:var(--muted) }
body[data-theme="light"] { --surface:#fff; --elev:#F6F7F9; --text:#1B1F29; --sub:#4A5260; --line:#DCE1EA }
body[data-theme="glass"] { --surface:#0B0E13; --elev:color-mix(in oklab,#0b0e13,#fff 10%); --text:var(--fg); --sub:var(--muted) }

/* Base */
*{box-sizing:border-box}
html,body,#app,#shell{height:100%}
body{
  margin:0;background:var(--surface);color:var(--text);
  font:400 var(--fz)/var(--lh) system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial;
  letter-spacing:-.005em; overflow:hidden; /* scroll di panel & center */
}
img{display:block;max-width:100%;height:auto}
button{font:inherit;color:inherit;background:none;border:0;cursor:pointer}
a{color:inherit;text-decoration:none}
a:hover{color:var(--accent)}
:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:10px}
.skip-link{position:absolute;left:-9999px}
.skip-link:focus{left:12px;top:10px;background:var(--elev);padding:8px 12px;border-radius:10px;z-index:9999}

/* Background video (aktif bila data-theme="glass" & data-bg="video") */
#bg{position:fixed;inset:0;z-index:0;pointer-events:none}
#bg video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .35s}
body[data-theme="glass"][data-bg="video"][data-motion="on"] #bg video{opacity:1}
body:not([data-theme="glass"]) #bg, body[data-bg="static"] #bg, body[data-motion="off"] #bg{display:none}

/* Layout (desktop push; mobile overlay) */
#shell.layout{
  display:grid; gap:var(--gap);
  grid-template-columns: var(--sb-left,0px) minmax(var(--center-min),1fr) var(--sb-right,0px);
  align-items:start;
}
.center{position:relative;min-width:0;min-height:0;height:100dvh;overflow:auto}
.center-wrap{width:min(100%,calc(var(--center-max)+2*var(--center-pad)));margin-inline:auto;padding-inline:var(--center-pad);display:flex;flex-direction:column;gap:var(--gap);min-height:100%}
/* “blank” saat panel terbuka */
#shell[data-left="open"] .center::before, #shell[data-right="open"] .center::before{
  content:"";position:absolute;inset:0;background:var(--surface);opacity:.94;z-index:1;pointer-events:none
}

/* Sidebars */
.sidebar{position:sticky;top:0;align-self:start;height:100dvh;background:var(--elev);border:1px solid var(--line);z-index:50;display:flex;flex-direction:column}
#sidebarLeft{width:var(--side-left)}
#sidebarRight{width:var(--side-right);border-left:1px solid var(--line)}
.sidebar[hidden]{display:none}
.sb-top,.sb-bottom{padding:12px;position:sticky;background:inherit}
.sb-top{top:0;border-bottom:1px solid var(--line)}
.sb-bottom{bottom:0;border-top:1px solid var(--line)}
.sb-mid{flex:1;overflow:auto;padding:12px}

/* Mobile overlay */
@media (max-width:1024px){
  #shell.layout{grid-template-columns:1fr}
  .sidebar{position:fixed;top:0;bottom:0;height:100dvh;width:min(92vw,340px);transform:translateX(-100%);transition:transform .2s}
  #sidebarRight{right:0;left:auto;transform:translateX(100%)}
  .sidebar.is-open{transform:translateX(0)}
}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.38);backdrop-filter:blur(1.5px);z-index:40}
.overlay[hidden]{display:none}

/* SidebarLeft — profil + label 2-level + pages */
.profile-card{display:flex;gap:12px;align-items:center;background:var(--elev);border:1px solid var(--line);border-radius:12px;padding:10px}
.avatar{width:72px;height:72px;border-radius:50%;border:1px solid var(--line)}
.eyebrow{margin:14px 0 6px;font-size:12px;color:var(--muted);letter-spacing:.04em;text-transform:uppercase}
.label-list,.page-list{display:grid;gap:8px}
.tree{border:1px solid var(--line);border-radius:12px}
.tree summary{list-style:none;display:grid;grid-template-columns:auto 1fr auto;gap:8px;align-items:center;cursor:pointer;padding:8px 10px}
.tree summary::-webkit-details-marker{display:none}
.tree .name{font-weight:600}
.tree .chev{transition:transform .15s}
.tree[open] .chev{transform:rotate(180deg)}
.tree .acc{padding:0 10px 10px 34px;display:grid;gap:6px}
.page-item,.acc a{display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:center;padding:6px;border-radius:10px}
.page-item:hover,.acc a:hover{background:rgba(255,255,255,.03)}
.count{opacity:.7}

/* Stream: bubble + postcard + readercard */
#roomchat{display:grid;gap:12px;padding:10px 0 calc(var(--barh)+var(--safe-b)+12px);min-height:40vh;scroll-behavior:smooth}
.bubble{display:inline-block;max-width:min(85%,65ch);padding:12px 14px;border:1px solid var(--line);border-radius:16px;background:var(--elev);position:relative}
.bubble.system{margin-right:auto}
.bubble.user{margin-left:auto;background:color-mix(in oklab,var(--ok),var(--elev) 88%)}
.bubble.system::after{content:"";position:absolute;left:-8px;bottom:10px;width:10px;height:10px;background:var(--elev);border-left:1px solid var(--line);border-bottom:1px solid var(--line)}
.bubble.user::after{content:"";position:absolute;right:-8px;bottom:10px;width:10px;height:10px;background:color-mix(in oklab,var(--ok),var(--elev) 88%);border-right:1px solid var(--line);border-bottom:1px solid var(--line)}

.postcard{background:var(--elev);border:1px solid var(--line);border-radius:16px;padding:10px}
.postcard .row{display:grid;grid-template-columns:96px 1fr;gap:12px;align-items:start}
.thumb{width:96px;height:96px;border-radius:12px;overflow:hidden;border:1px solid var(--line);background:#0c111d}
.thumb img{width:100%;height:100%;object-fit:cover}
.title{margin:0 0 6px;font-weight:800}
.meta{display:flex;gap:14px;flex-wrap:wrap;color:var(--muted);font-size:var(--fz-s)}
.excerpt{margin:6px 0 4px;color:#dfe6f8}
.actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;margin-top:8px}
.iconbtn{display:inline-flex;gap:6px;align-items:center;border:1px solid var(--line);border-radius:10px;background:var(--raise);padding:8px 10px;min-height:40px}
.iconbtn:hover{border-color:var(--accent);color:var(--accent)}
.iconbtn svg{flex:0 0 18px}
@media (max-width:520px){ .iconbtn span{display:none} .iconbtn{padding:8px} }
@media (max-width:420px){ .postcard .row{grid-template-columns:1fr} .thumb{width:100%;height:auto;aspect-ratio:4/3} }

.readercard{background:var(--elev);border:1px solid var(--line);border-radius:16px;overflow:hidden}
.reader-head{padding:14px 14px 8px}
.reader-title{margin:0 0 6px;font-weight:900}
.reader-meta{display:flex;gap:16px;flex-wrap:wrap;color:var(--muted);font-size:var(--fz-s)}
.reader-body{padding:0 14px 14px}
.reader-body img{border-radius:12px;border:1px solid var(--line);max-width:100%}
.reader-actions{display:flex;gap:8px;padding:10px 14px;border-top:1px solid var(--line);background:color-mix(in oklab,var(--elev),#fff 2%)}

/* Chatbar */
.chatbar{position:sticky;bottom:0;left:0;right:0;background:transparent}
.chat-form{position:fixed;left:0;right:0;bottom:0;padding:8px 12px calc(10px + var(--safe-b));background:var(--elev);border-top:1px solid var(--line);z-index:45}
.chat-form form{display:grid;grid-template-columns:repeat(2,auto) 1fr repeat(5,auto);gap:8px;align-items:center;max-width:var(--center-max);margin:0 auto}
.chip{display:inline-flex;align-items:center;justify-content:center;width:var(--chip);height:var(--chip);border-radius:999px;border:1px solid var(--line)}
.chat-form input[type="text"]{min-width:0;background:#0e1424;border:1px solid var(--line);border-radius:12px;padding:10px 12px;color:var(--fg)}
.chat-note{margin:8px auto 0;max-width:var(--center-max);text-align:center;color:var(--muted);font-size:var(--fz-s)}

/* SmartScroll */
.smartscroll{position:fixed;right:14px;bottom:calc(var(--barh) + 18px);z-index:70;display:inline-flex;gap:8px;align-items:center;padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:var(--elev)}
.smartscroll[hidden]{display:none}

/* Perf & CLS */
img[loading="lazy"]{content-visibility:auto}
