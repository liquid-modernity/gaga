/* =======================================================
   Gaga Theme — CSS minimal, performa tinggi (PSI 100)
   ======================================================= */

/* ---- Tokens ---- */
:root{
  --center-max: 880px; --center-min: 360px; --center-pad: 16px;
  --r-8:8px; --r-12:12px; --r-16:16px; --r-18:18px; --r-pill:999px;
  --sp-1:4px; --sp-2:8px; --sp-3:12px; --sp-4:16px; --sp-5:24px;

  --bg-surface-dark:#0B0E13; --bg-elevated-dark:#141923; --text-primary-dark:#E7EAF0; --text-secondary-dark:#B5BAC6; --border-dark:#2A3040;
  --bg-surface-light:#FFFFFF; --bg-elevated-light:#F6F7F9; --text-primary-light:#1B1F29; --text-secondary-light:#4A5260; --border-light:#DCE1EA;

  --info:#2F80ED; --success:#27AE60; --warn:#E2B93B; --error:#E53935; --accent:#D81B60;

  --shadow-dark:0 6px 24px rgba(0,0,0,.25);
  --shadow-light:0 6px 24px rgba(0,0,0,.08);

  --t-fast:140ms; --t-overlay:220ms;
  --z-side:1300; --z-dock:1400; --z-overlay:1250; --z-header:1500;

  --safe-b:env(safe-area-inset-bottom,0px);
  --ts:1; --fz-base:calc(16px*var(--ts)); --lh-base:1.65; --fz-small:calc(14px*var(--ts)); --lh-small:1.55;

  --chip:48px; --gap:10px; --input-pad-y:10px; --chatbar-h:64px;

  --w-left:280px; --w-right:360px; /* desktop push */
  --sb-left:0px; --sb-right:0px;  /* diubah via JS */
}
body[data-density="compact"]{ --chip:44px; --gap:8px; --input-pad-y:8px }

/* Themes */
body[data-theme="dark"] { --bg-surface:var(--bg-surface-dark); --bg-elevated:var(--bg-elevated-dark); --text-primary:var(--text-primary-dark); --text-secondary:var(--text-secondary-dark); --border-muted:var(--border-dark); --shadow:var(--shadow-dark) }
body[data-theme="light"]{ --bg-surface:var(--bg-surface-light); --bg-elevated:var(--bg-elevated-light); --text-primary:var(--text-primary-light); --text-secondary:var(--text-secondary-light); --border-muted:var(--border-light); --shadow:var(--shadow-light) }
body[data-theme="glass"]{ --bg-surface:#0B0E13; --bg-elevated:color-mix(in oklab,#0b0e13,#fff 10%); --text-primary:var(--text-primary-dark); --text-secondary:var(--text-secondary-dark); --border-muted:var(--border-dark); --shadow:var(--shadow-dark) }

/* ---- Base ---- */
*{box-sizing:border-box}
html,body,#app,#shell{height:100%}
body{
  margin:0; color:var(--text-primary); background:var(--bg-surface);
  font:400 var(--fz-base)/var(--lh-base) system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial;
  letter-spacing:-.005em; overflow:hidden; /* scroll di center & side panels */
}
img{display:block;max-width:100%;height:auto}
button,input{font:inherit;color:inherit}
button{cursor:pointer;background:none;border:0}
:where(a,button,[role="button"],input):focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:10px}
.skip-link{position:absolute;left:-9999px}
.skip-link:focus{left:12px;top:12px;background:var(--bg-elevated);padding:8px 12px;border-radius:10px;z-index:var(--z-header)}

/* Hover magenta */
a:hover{color:var(--accent)}
.iconbtn:hover,.rs-tab:hover,.label-item:hover,.page-item:hover,.btn-infield:hover,.chip:hover{
  border-color:var(--accent); color:var(--accent);
  box-shadow:0 0 0 2px color-mix(in oklab,var(--accent),transparent 85%) inset;
}

/* Overlay */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.35);z-index:var(--z-overlay);opacity:0;transition:opacity var(--t-overlay) ease}
.overlay[hidden]{display:none}
.overlay:not([hidden]){opacity:1}

/* BG video (Glass) */
#bg{position:fixed;inset:0;z-index:0;pointer-events:none}
#bg video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .4s ease}
#bg .bg-fallback{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.28),rgba(0,0,0,.55))}
body:not([data-theme="glass"]) #bg, body[data-motion="off"] #bg, body[data-bg="static"] #bg{display:none}
body[data-theme="glass"][data-motion="on"][data-bg="video"] #bg video{opacity:1}

/* ---- Layout (desktop push) ---- */
#shell.layout{
  display:grid;
  grid-template-columns: var(--sb-left) minmax(var(--center-min),1fr) var(--sb-right);
  gap: var(--gap);
  align-items:start;
}
.center{position:relative;display:flex;flex-direction:column;min-height:0;min-width:0;height:100dvh;overflow:auto;-webkit-overflow-scrolling:touch}
.center-wrap{width:min(100%,calc(var(--center-max)+2*var(--center-pad)));margin-inline:auto;padding-inline:var(--center-pad);min-height:100%;display:flex;flex-direction:column;gap:var(--gap);min-width:0}

/* Saat sidebar terbuka → center blank (fokus ke panel) */
#shell.layout[data-left="open"] .center::before,
#shell.layout[data-right="open"] .center::before{
  content:""; position:absolute; inset:0; background:var(--bg-surface); opacity:.92; pointer-events:none; z-index:1;
}

/* Sidebars */
.sidebar{
  position:sticky; top:0; align-self:start; height:100dvh;
  width:var(--w-left); z-index:var(--z-side);
  display:flex;flex-direction:column;background:var(--bg-elevated);
  -webkit-backdrop-filter:blur(14px) saturate(1.1);backdrop-filter:blur(14px) saturate(1.1);
  border:1px solid color-mix(in oklab,#fff,transparent 90%);
}
#sidebarRight{ width:var(--w-right); border-left:1px solid var(--border-muted); }
.sidebar[hidden]{display:none}
.sb-top,.sb-bottom{padding:var(--sp-4);position:sticky;background:inherit}
.sb-top{top:0;border-bottom:1px solid var(--border-muted)}
.sb-bottom{bottom:0;border-top:1px solid var(--border-muted)}
.sb-mid{flex:1;overflow:auto;padding:var(--sp-4)}

/* Mobile overlay sidebar */
@media (max-width:1024px){
  #shell.layout{ grid-template-columns:1fr; }
  .sidebar{ position:fixed; top:0; bottom:0; height:100dvh; width:min(92vw,340px); transform:translateX(-100%); transition:transform var(--t-overlay); }
  #sidebarRight{ right:0; left:auto; transform:translateX(100%); }
  .sidebar.is-open{ transform:translateX(0); }
}

/* ---- SidebarLeft: Profile + Label 2-level + Pages ---- */
.profile-card{display:flex;gap:12px;align-items:center;margin-bottom:12px;background:var(--bg-elevated);border:1px solid var(--border-muted);border-radius:12px;padding:10px}
.avatar-wrap{position:relative}.avatar{width:72px;height:72px;border-radius:50%;border:1px solid var(--border-muted);background:#0003}
.verify{position:absolute;right:-2px;bottom:-2px;background:color-mix(in oklab,var(--info),#000 10%);color:#fff;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;border:2px solid var(--bg-elevated)}
.p-name{display:block;font-weight:700}.p-desc{margin:2px 0 0;color:var(--text-secondary);font-size:var(--fz-small)}

.label-list{display:grid;gap:8px;margin-top:8px}
.label-item{border:1px solid var(--border-muted);border-radius:12px;background:var(--bg-elevated);padding:6px}
.label-item summary{list-style:none;display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:8px;cursor:pointer}
.label-item summary::-webkit-details-marker{display:none}
.label-item .count{opacity:.75}
.label-item .acc{display:none;margin-top:8px;display:grid;gap:6px}
.label-item[open] .acc{display:grid}
.label-item .chev{transition:transform var(--t-fast)}
.label-item[open] .chev{transform:rotate(180deg)}

.page-list{display:grid;gap:8px;margin-top:8px}
.page-item{display:grid;grid-template-columns:auto 1fr;align-items:center;gap:8px;border:1px solid var(--border-muted);border-radius:10px;padding:8px 10px}

/* Footer left */
.quote{text-align:center;margin:0 0 10px;color:var(--text-secondary);font-size:var(--fz-small)}
.socials{display:flex;gap:10px;justify-content:center;margin-bottom:8px}
.socials a{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:10px;border:1px solid var(--border-muted);background:var(--bg-elevated)}
.copyright{display:block;text-align:center;color:var(--text-secondary)}

/* ---- Stream & Postcard ---- */
#roomchat{flex:1;overflow:auto;display:grid;gap:var(--sp-4);padding:8px 0 calc(var(--chatbar-h) + var(--safe-b) + 12px);scroll-behavior:smooth;min-width:0}
.postcard{display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center;background:var(--bg-elevated);border:1px solid var(--border-muted);border-radius:18px;padding:12px;container-type:inline-size}
.postcard .thumb{border-radius:12px;overflow:hidden;border:1px solid var(--border-muted);aspect-ratio:4/3;background:#0003}
.postcard .title{font-weight:700;margin:0 0 6px;overflow-wrap:anywhere}
.postcard .excerpt{margin:0 0 8px;color:var(--text-secondary);overflow-wrap:anywhere}
.postcard .meta{display:flex;flex-wrap:wrap;gap:16px;align-items:center;color:var(--text-secondary);font-size:var(--fz-small);line-height:1.4}
.postcard .actions{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
.iconbtn{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border-muted);background:var(--bg-elevated);border-radius:10px;padding:8px 10px;min-height:44px;min-width:44px}
.iconbtn svg{flex:0 0 18px}
@container (max-width:560px){ .iconbtn span{display:none} .iconbtn{padding:8px} }
@media (max-width:520px){ .iconbtn span{display:none} .iconbtn{padding:8px} }
@media (max-width:420px){ .postcard{grid-template-columns:1fr} .postcard .actions{margin-left:0} }

/* ---- Reader ---- */
.readercard{background:var(--bg-elevated);border:1px solid var(--border-muted);border-radius:18px;overflow:hidden}
.reader-head{padding:16px 16px 8px}
.reader-title{margin:0 0 6px;font-weight:800}
.reader-meta{display:flex;flex-wrap:wrap;gap:16px;color:var(--text-secondary);font-size:var(--fz-small);line-height:1.4}
.reader-meta > span{display:inline-flex;align-items:center;gap:6px}
.reader-body{padding:0 16px 16px}
.reader-body img{border-radius:12px;border:1px solid var(--border-muted);max-width:100%}
.reader-actions{display:flex;gap:8px;padding:10px 16px;border-top:1px solid var(--border-muted);background:color-mix(in oklab,var(--bg-elevated),#fff 2%);container-type:inline-size}
@container (max-width:480px){ .reader-actions .iconbtn span{display:none} .reader-actions .iconbtn{padding:8px} }

/* ---- Bubbles ---- */
.bubble{position:relative;display:inline-block;vertical-align:top;padding:12px 14px;border-radius:18px;max-width:min(85%,65ch);background:var(--bg-elevated);border:1px solid var(--border-muted);box-shadow:0 1px 0 rgba(0,0,0,.06)}
.bubble p{margin:0}
body[data-bubble="wrap"] .bubble{display:block;max-width:65ch}
.bubble[data-role="system"]{margin-right:auto}
.bubble[data-role="system"]::after{content:"";position:absolute;left:-8px;bottom:10px;width:10px;height:10px;background:var(--bg-elevated);border-left:1px solid var(--border-muted);border-bottom:1px solid var(--border-muted)}
.bubble[data-role="user"]{margin-left:auto;background:color-mix(in oklab,var(--success),var(--bg-elevated) 90%)}
.bubble[data-role="user"]::after{content:"";position:absolute;right:-8px;bottom:10px;width:10px;height:10px;background:color-mix(in oklab,var(--success),var(--bg-elevated) 90%);border-right:1px solid var(--border-muted);border-bottom:1px solid var(--border-muted)}
.bubble--info{--c:var(--info)} .bubble--success{--c:var(--success)} .bubble--warn{--c:var(--warn)} .bubble--error{--c:var(--error)}
.bubble[class*="bubble--"]{box-shadow:0 0 0 1px color-mix(in oklab,var(--c),transparent 70%) inset;background:color-mix(in oklab,var(--c),var(--bg-elevated) 94%)}

/* SmartScroll */
.smartscroll{position:fixed;right:clamp(16px,4vw,28px);bottom:calc(var(--chatbar-h) + 18px);z-index:1405;display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--border-muted);border-radius:999px;background:var(--bg-elevated);box-shadow:var(--shadow);color:inherit}
.smartscroll[hidden]{display:none}

/* Chatbar */
.chatbar{position:sticky;bottom:0;left:0;right:0;padding:8px 0 calc(8px + var(--safe-b));background:transparent;z-index:var(--z-header);container-type:inline-size}
.chat-form{display:grid;grid-template-columns:repeat(2,auto) 1fr repeat(5,auto);align-items:center;gap:8px;background:var(--bg-elevated);border:1px solid var(--border-muted);border-radius:999px;padding:0 8px;box-shadow:var(--shadow)}
.chat-form .chip{display:inline-flex;align-items:center;justify-content:center;width:var(--chip);height:var(--chip);border-radius:999px;border:1px solid var(--border-muted)}
.chat-form input[type="text"]{min-width:0;border:0;background:transparent;padding-block:var(--input-pad-y);padding-inline:8px;outline:none}

/* Dockbar (top sheet) */
.dock{position:fixed;inset:0;z-index:var(--z-dock)}
.dock[hidden]{display:none}
.dock__scrim{position:absolute;inset:0;background:rgba(0,0,0,.35)}
.dock__sheet{position:absolute;left:50%;top:0;transform:translateX(-50%);width:min(100%,640px);background:var(--bg-elevated);border:1px solid var(--border-muted);border-bottom-left-radius:14px;border-bottom-right-radius:14px;box-shadow:var(--shadow);max-height:calc(100dvh - var(--safe-b));overflow:auto}
.dock__head{display:flex;justify-content:flex-end;padding:6px}
.sheet-handle{width:52px;height:5px;border-radius:999px;background:color-mix(in oklab,#fff,transparent 86%);margin:8px auto}
.dock__group{padding:12px 14px}
.eyebrow{margin:0 0 8px;font-size:var(--fz-small);text-transform:uppercase;letter-spacing:.06em;color:var(--text-secondary)}
.tile-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
@media (max-width:640px){ .tile-grid{grid-template-columns:repeat(2,minmax(0,1fr))} }
.tile{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px;border:1px solid var(--border-muted);border-radius:12px;background:var(--bg-elevated)}

/* Aspect-ratio wrappers (anti-CLS) */
.ar-1-1,.ar-4-5,.ar-16-9,.ar-9-16,.ar-3-4{position:relative;overflow:hidden;border-radius:12px;border:1px solid var(--border-muted)}
.ar-1-1{aspect-ratio:1/1}.ar-4-5{aspect-ratio:4/5}.ar-16-9{aspect-ratio:16/9}.ar-9-16{aspect-ratio:9/16}.ar-3-4{aspect-ratio:3/4}
.ar-1-1>img,.ar-4-5>img,.ar-16-9>img,.ar-9-16>img,.ar-3-4>img{width:100%;height:100%;object-fit:cover}

/* Lazy hint */
img[loading="lazy"]{content-visibility:auto}
